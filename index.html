<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Zoro-Mapbox</title>
    <link rel="stylesheet" href="./css/base.css" />
    <script src="/js/tokenmapbox.js"></script>
  </head>
  <body>
    <h1>Zoro Mapbox</h1>
    <div id="map"></div>
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.js"></script>
    <link
      href="https://api.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.css"
      rel="stylesheet"
    />
    <script>
      mapboxgl.accessToken = token_mapbox;
      var map = new mapboxgl.Map({
        container: "map",
        style: "mapbox://styles/mapbox/streets-v11",
        center: [108.22760806240348, 16.06130596951281], // Thay đổi longitude và latitude tùy theo vị trí mong muốn
        zoom: 13, // Thay đổi mức zoom tùy theo mong muốn
      });
      fetch("data.json")
        .then((res) => res.json())
        .then((json) => {

          var markers = json.data.markers;

          markers.forEach(function (markerData) {

            var typeMark = "marker-1";
            if (markerData.type == 2) {
              typeMark = "marker-2";
            } else if (markerData.type == 3) {
              typeMark = "marker-3";
            } else if (markerData.type == 4) {
              typeMark = "marker-4";
            } else if (markerData.type == 5) {
              typeMark = "marker-5";
            }

            var customIcon = document.createElement("div");
            customIcon.className = `mapboxgl-marker ${typeMark}`;
            var marker = new mapboxgl.Marker({ element: customIcon })
              .setLngLat([markerData.lon, markerData.lat])
              .addTo(map);

            var popup = new mapboxgl.Popup().setHTML(
              `<h3>${typeMark} Marker Popup</h3><p>This is a ${typeMark} marker.</p>`
            );

            marker.setPopup(popup);
            
            marker.on("click", function () {
              marker.togglePopup();
            });

          });
        });
    </script>
  </body>
</html>
